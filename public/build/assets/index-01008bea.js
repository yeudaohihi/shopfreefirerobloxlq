import{r as w,c as ae,o as ne,a as i,b as d,d as l,w as r,e as x,f as E,g as t,h as c,F as y,i as k,j as b,k as oe,t as f,n as K,l as se,A as le}from"./chunk-1f342eb4.js";import"./chunk-e47d8634.js";const re=["onSubmit"],ie={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},ce=t("label",{for:"form-label"},"Chọn mức giá: ",-1),ue=t("label",{for:"form-label"},"Tìm kiếm: ",-1),de={class:"grid grid-cols-2 gap-3"},pe=t("div",null,[t("button",{class:"btn btn-sm btn-primary w-full lg:mt-[22px]"},[t("i",{class:"fas fa-search"}),b(" Tìm kiếm ")])],-1),ge=t("i",{class:"fas fa-trash"},null,-1),me={key:0},_e={style:{background:"transparent"},class:"border border-primary rounded-lg p-[1px]"},ve={class:"text-center text-lg font-bold bg-primary text-white",style:{"margin-top":"-6px"}},he={class:"p-3"},fe={class:"grid grid-cols-2 mb-3 gap-3"},be={class:"font-bold text-wrap"},we={class:"text-center grid grid-cols-2 gap-3"},xe={class:"col-span-2"},ye={class:"border border-red-500 rounded-lg p-1 font-bold"},ke={class:"text-green-600"},Ce=t("i",{class:"fas fa-credit-card me-2"},null,-1),Te=["onClick"],Ie=t("i",{class:"fas fa-shopping-cart me-2"},null,-1),Se=t("span",null,"Mua Ngay",-1),Be=[Ie,Se],$e={class:"text-center mt-3"},Pe={class:"list-none"},Me={class:"inline-block"},Ue=["onClick"],Ne={class:"inline-block"},je={__name:"Index",props:{groupId:{type:String,default:0}},setup(R){const A=R,v=w({price:"",search:""}),o=w({page:1,limit:16,total_rows:0,total_page:0,visible_pages:[]}),Q=ae(()=>{const{page:a,total_page:n,visible_pages:s}=o.value,u=5;let _=Math.max(a-Math.floor(u/2),1),h=Math.min(_+u-1,n);return h-_+1<u&&(_=Math.max(h-u+1,1)),Array.from({length:h-_+1},(P,I)=>_+I)}),O=a=>{o.value.page!==a&&(o.value.page=a,p())},q=()=>{o.value.page<=1||(o.value.page--,p())},z=()=>{o.value.page>=o.value.total_page||(o.value.page++,p())},G=w([{label:"Tất cả",value:""},{label:"Dưới 100.000đ",value:"0-100000"},{label:"100.000đ - 200.000đ",value:"100000-200000"},{label:"200.000đ - 500.000đ",value:"200000-500000"},{label:"500.000đ - 1.000.000đ",value:"500000-1000000"},{label:"1.000.000đ - 2.000.000đ",value:"1000000-2000000"},{label:"2.000.000đ - 5.000.000đ",value:"2000000-5000000"},{label:"5.000.000đ - 10.000.000đ",value:"5000000-10000000"},{label:"Trên 10.000.000đ",value:"10000000-0"}]),g=w(!1),C=w([]),p=async()=>{var a,n;g.value=!0;try{const{data:s}=await axios.get("/api/stores/accounts-v2",{params:{...v.value,group_id:A.groupId,...o.value}});m("page")!==null&&o.value.page!==parseInt(m("page"))&&$("product_id"),o.value.page!==1?Y("page",o.value.page):$("page"),C.value=((a=s.data)==null?void 0:a.data)||[],o.value=((n=s.data)==null?void 0:n.meta)||[]}catch(s){Swal.fire("Thất Bại",$catchMessage(s),"error")}finally{const s=m("product_id");setTimeout(s?()=>{const u=document.getElementById("card_"+s);u&&u.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}:X,500),setTimeout(()=>{g.value=!1},600)}},H=()=>{o.value.page=1,p()},J=()=>{v.value={price:"",search:""},o.value.page=1,p()},W=(a,n="VND",s=2)=>new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}).format(a)+" ₫",B=async a=>{if((await Swal.fire({icon:"question",title:"Bạn chắc chứ?",text:`Bạn sẽ mua TK #${a.code} với giá ${a.price_str}?`,showCancelButton:!0,confirmButtonText:"Mua ngay",cancelButtonText:"Hủy bỏ"})).isConfirmed===!0){Swal.fire({icon:"info",title:"Đang xử lý!",html:"Không được tắt trang này, vui lòng đợi trong giây lát!",timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:()=>{Swal.showLoading()},willClose:()=>{}});try{const{data:s}=await axios.post("/api/stores/accounts-v2/"+a.code+"/buy");Swal.fire("Thành Công",s.message,"success").then(()=>{window.open("/account/orders/accounts-v2/"+s.data.code,"_self")})}catch(s){Swal.fire("Thất Bại",$catchMessage(s),"error")}}},X=()=>{window.scrollTo({top:0,behavior:"smooth"})},Y=(a,n)=>{if(parseInt(m(a))===parseInt(n))return;const s=new URL(window.location.href);s.searchParams.set(a,n),window.history.pushState({},"",s)},$=a=>{if(m(a)===null)return;const n=new URL(window.location.href);n.searchParams.delete(a),window.history.pushState({},"",n)},m=a=>new URL(window.location.href).searchParams.get(a);return window.addEventListener("popstate",()=>{const a=m("page");a&&o.value.page!==parseInt(a)?(o.value.page=parseInt(a),p()):!a&&o.value.page!==1&&(o.value.page=1,p())}),ne(()=>{const a=m("page");a&&(o.value.page=parseInt(a)),p()}),(a,n)=>{var V,D;const s=i("a-select-option"),u=i("a-select"),_=i("a-input"),h=i("a-spin"),P=i("a-image"),I=i("a-button"),M=i("a-tooltip"),U=i("a-badge-ribbon"),N=i("a-col"),j=i("a-row"),Z=i("a-skeleton"),F=i("a-card"),ee=i("a-empty"),L=i("iconify-icon");return c(),d("section",null,[l(h,{spinning:g.value},{default:r(()=>[t("form",{class:"mb-5 mt-5",onSubmit:oe(H,["prevent"])},[t("div",ie,[t("div",null,[ce,l(u,{value:v.value.price,"onUpdate:value":n[0]||(n[0]=e=>v.value.price=e),placeholder:"Chọn mức giá",style:{width:"100%"}},{default:r(()=>[(c(!0),d(y,null,k(G.value,e=>(c(),x(s,{key:e.value,value:e.value},{default:r(()=>[b(f(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),t("div",null,[ue,l(_,{value:v.value.search,"onUpdate:value":n[1]||(n[1]=e=>v.value.search=e),placeholder:"Tìm kiếm nak, vio, but, flo,...",style:{width:"100%"}},null,8,["value"])]),t("div",de,[pe,t("div",null,[t("button",{class:"btn btn-sm btn-danger w-full lg:mt-[22px]",type:"button",onClick:n[2]||(n[2]=e=>J())},[ge,b(" Đặt lại ")])])])])],40,re)]),_:1},8,["spinning"]),((V=C.value)==null?void 0:V.length)!==0&&!g.value?(c(),d("div",me,[g.value?(c(),x(j,{key:1,gutter:18},{default:r(()=>[(c(),d(y,null,k(16,e=>l(N,{xs:12,sm:8,lg:6,key:e},{default:r(()=>[l(F,{class:"mb-3 h-[303px]"},{default:r(()=>[l(Z,{active:""})]),_:1})]),_:2},1024)),64))]),_:1})):(c(),x(j,{key:0,gutter:18},{default:r(()=>[(c(!0),d(y,null,k(C.value,e=>(c(),x(N,{xs:24,md:8,lg:6,key:e.id,class:"mb-2 mt-2 cursor-pointer"},{default:r(()=>[l(U,{color:"red",text:`-${e.discount}%`,class:K({hidden:e.discount<=0}),placement:"start"},{default:r(()=>[l(U,{color:"pink",text:`MS: ${e.code}`,placement:"end"},{default:r(()=>[t("div",_e,[l(P,{src:e.image,alt:e.name,width:"100%",height:"sm:200px lg:170px",class:"rounded-t-lg"},null,8,["src","alt"]),t("div",ve,f(e.name),1),t("div",he,[t("div",fe,[(c(!0),d(y,null,k(e.highlights,(T,te)=>(c(),d("div",{key:te,class:"lg:col-span-1"},[t("div",be,f(T),1)]))),128))]),t("div",we,[t("div",xe,[t("div",ye,[b(" Còn lại "),t("span",ke,f(e.amount),1),b(" nick ")])]),l(M,{title:e.discount!==0?`Giá gốc ${W(e.price)}`:""},{default:r(()=>[l(I,{type:"dashed",block:"",onClick:T=>B(e),class:"dark:text-white"},{default:r(()=>[Ce,b(" "+f(e.price_str),1)]),_:2},1032,["onClick"])]),_:2},1032,["title"]),l(M,{title:e.name},{default:r(()=>[t("button",{class:"btn btn-sm btn-primary w-full",onClick:T=>B(e)},Be,8,Te)]),_:2},1032,["title"])])])])]),_:2},1032,["text"])]),_:2},1032,["text","class"])]),_:2},1024))),128))]),_:1}))])):E("",!0),((D=C.value)==null?void 0:D.length)===0&&!g.value?(c(),x(F,{key:1},{default:r(()=>[l(ee,{description:"Không tìm thấy tài khoản nào trong nhóm này"})]),_:1})):E("",!0),t("div",$e,[l(h,{spinning:g.value},{default:r(()=>[t("ul",Pe,[t("li",Me,[t("a",{href:"javascript:void(0)",onClick:n[3]||(n[3]=e=>q()),class:"flex items-center justify-center w-6 h-6 bg-slate-100 dark:bg-slate-700 dark:hover:bg-black-500 text-slate-800 dark:text-white rounded mx-[3px] sm:mx-1 hover:bg-black-500 hover:text-white text-sm font-Inter font-medium transition-all duration-300 relative top-[2px] pl-2"},[l(L,{icon:"material-symbols:arrow-back-ios-rounded"})])]),(c(!0),d(y,null,k(Q.value,e=>(c(),d("li",{key:e,class:"inline-block"},[t("a",{href:"javascript:void(0)",onClick:T=>O(e),class:K(["flex items-center justify-center w-6 h-6 bg-slate-100 text-slate-800 dark:text-white rounded mx-[3px] sm:mx-1 hover:bg-black-500 hover:text-white text-sm font-Inter font-medium transition-all duration-300",{"p-active":o.value.page===e}])},f(e!==-1?e:"..."),11,Ue)]))),128)),t("li",Ne,[t("a",{href:"javascript:void(0)",onClick:n[4]||(n[4]=e=>z()),class:"flex items-center justify-center w-6 h-6 bg-slate-100 dark:bg-slate-700 dark:hover:bg-black-500 text-slate-800 dark:text-white rounded mx-[3px] sm:mx-1 hover:bg-black-500 hover:text-white text-sm font-Inter font-medium transition-all duration-300 relative top-[2px]"},[l(L,{icon:"material-symbols:arrow-forward-ios-rounded"})])])])]),_:1},8,["spinning"])])])}}},S=se({});S.use(le);S.component("account-index",je);S.mount("#app");
